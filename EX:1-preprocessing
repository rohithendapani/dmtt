from sklearn.linear_model import LinearRegression 
from sklearn.metrics import r2_score, mean_squared_error 
import matplotlib.pyplot as plt 
import numpy as np 
import pandas as pd 
from sklearn.datasets import load_diabetes 
from sklearn.model_selection import train_test_split 
data = load_diabetes() 
df = pd.DataFrame(data.data, columns = data.feature_names) 
df['target'] = data.target 
if df.isnull().values.any(): 
df.fillna(df.mean()) 
X = df[['bmi']] 
y = df['target'] 
print(data.feature_names) 
X_train, X_test, y_train, y_test = train_test_split(X,y) 
model = LinearRegression() 
model.fit(X_train,y_train) 
y_pred = model.predict(X_test) 
r2 = r2_score(y_test,y_pred) 
print(f"r2 score is {round(r2,3)}") 
mse = mean_squared_error(y_test,y_pred) 
print(f"MSE is {round(mse,3)}") 
plt.scatter(X_test,y_test,c="blue",label="Actual") # plots the test set using scatter plot 
plt.plot(X_test,y_pred,color = "green", label="Predicted") # plots the predicted line using plot 
plt.title("Linear Regression for the Diabetes Dataset using BMI value") 
plt.xlabel("BMI") 
plt.ylabel("Disease Progression") 
plt.legend() 
plt.show()
